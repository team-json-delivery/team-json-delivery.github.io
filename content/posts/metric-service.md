---
title: '장애, 모니터링, 그리고 알람 이야기 😊'
date: 2024-03-09T09:00:00+09:00
author: "zoster0828"
cover:
  image: "/images/metric-service/cover.png"
---


## 1. 🤔 장애가 뭔가요? 
![img.png](/images/metric-service/dont3.png)

> 장애란, 우리가 쓰는 시스템이나 서비스가 제대로 작동하지 않는 상태를 말해요. 
> 
> 이런 문제는 네트워크가 느리거나 서버에 문제가 생기거나 
> 
> 데이터베이스가 이상한 등 다양한 이유로 생길 수 있어요. 
> 
> DEVOPS와 microservice로 인한 모듈 파편화에 따라 이러한 모니터링, 또는 관측성이 더욱 중시되고 있어요!

## 2. 🏢 각 회사들은 장애를 어떻게 다루나요? 
> 각 회사마다 장애에 대처하는 자신만의 방식이 있어요. 
> 
> 어떤 곳은 문제가 터지면 바로 알려줄 수 있는 시스템을 갖추고, 
> 
> 빨리 해결할 수 있도록 준비하는 곳도 있고요.
> 
> 또, 장애에 어떻게 대응할지 프로세스를 확실하게 해두고, 
> 
> 모든 사람이 뭘 해야 할지 바로 알 수 있게 교육시키는 곳도 있어요 📚.
> 
> 어느것이 더 낫다고 할수는 없지만 시스템 규모나 중요도에 따라 적절하게 구성해야 하겠죠.

### 📖팀원들이 겪었던 실제 장애 사례들을 살펴볼까요? 
![img.png](/images/metric-service/fault.png)

~~안돼~~
> 현장에서 실제로 발생했던 장애 사례를 통해, 우리는 중요한 교훈을 얻을 수 있어요. 
> 
> 이런 사례들을 통해 앞으로 비슷한 상황을 방지하기 위한 대책을 세울 수도 있죠. 몇 가지 사례를 들어볼게요:

* 데이터베이스 마이그레이션 사고
  * 한 회사에서 데이터베이스를 새로운 시스템으로 옮기는 작업 중에, 엄청난 준비에도 불구하고 실수로 큰 장애가 발생했어요.
  
* 알림 시스템 실패
  * 배송 알림을 보내는 시스템에서, 개발 환경에서는 발견되지 않았던 문제 때문에 운영 환경에서 큰 혼란이 생겼어요. 

* 의도치 않은 직배송 문제
  * 주문 시스템에서 작은 코드 오류로 인해 모든 주문이 직배송으로 처리되는 큰 문제가 발생했어요. 

* 결제 시스템 오류
  * 결제 시스템에 문제가 생겨 결제 실패율이 급증했고, 이는 매출 손실과 고객 신뢰도 저하로 이어졌어요.

> 이런 사례들을 통해, 우리는 장애 발생 시 신속하게 대응하고, 문제의 근본 원인을 파악하며, 비슷한 상황을 미리 방지하기 위한 대책을 마련할 수 있어요.
> 
> 그리고 무엇보다, 팀으로서 함께 문제를 해결해 나가는 과정에서 서로를 더 잘 이해하고 협력할 수 있는 기회가 될 수 있어요.
> 
> 하지만 가장 중요한 것은 문제를 빨리 알아챌 수 있냐는 것이죠!


## 3. 📊 팀원들의 회사에서는 실제로 어떻게 모니터링하죠? 
![img.png](/images/metric-service/monitoring.png)


> 장애 모니터링은 문제를 바로 찾아내고, 왜 그런 일이 벌어졌는지 알아내고, 
> 
> 빨리 해결할 수 있는 방법을 찾는 중요한 단계예요. 실제로 여러 방법을 써요.

* 인프라와 서비스 모니터링 도구
  * Prometheus, InfluxDB database에 저장한 시스템 상태를 실시간으로 지켜보고,
   문제가 생기면 바로 알림을 받을 수 있어요.

* 응답 시간 체크
  * 서비스가 얼마나 빨리 응답하는지 계속 체크해서, 만약 느려지면 바로 알아챌 수 있어요. 
   이렇게 하면 사용자 경험에 나쁜 영향을 최소화할 수 있죠.
* 이벤트 로깅과 분석
  * ELK 스택 같은 로깅 시스템으로 일어나는 모든 일을 기록하고 분석해요. 
   이를 통해 문제의 원인을 파악하고, 어떻게 대처할지 방법을 찾을 수 있어요.
* 비즈니스 지표 모니터링
  * Datadog, Grafana 같은 도구로 비즈니스 지표도 눈에 띄게 지켜봐요. 
   시스템은 멀쩡한데 갑자기 지표가 떨어지면, 뭔가 문제가 있을 수도 있으니까요.


> 이러한 동작들을 처리하는 시스템을 통합 모니터링 시스템이라고 불러요. 
> 
> 이런 식으로 장애 모니터링 시스템을 잘 꾸려놓고 운영하면, 
> 
> 문제가 생겼을 때 바로 대응할 수 있고, 시스템을 더 안정적으로 만들 수 있어요.
> 
> 우리가 이제 곧 설계해볼거예요!

## 4. 💻 팀원들의 회사에서 쓰는 모니터링 시스템은 어떤 스펙을 가지고 있고, 개발자에게 어떻게 알림을 줄까요? 
> 현업에서 쓰는 모니터링 시스템은 정말 다양한 기능과 스펙을 가지고 있어서, 시스템 상태를 실시간으로 지켜보고, 
> 
> 문제가 생기면 개발자한테 바로 알려줄 수 있어요. 이 시스템들은 보통 이런 특징을 갖고 있어요

* 높은 가용성과 확장성
  * 어떤 상황에서든 모니터링이 멈추지 않도록 하고,
   서비스가 커질 때 쉽게 늘릴 수 있어야 해요.
* 다양한 데이터 소스
  * 로그, 메트릭, 트레이스 등 여러 데이터 소스에서 정보를 모을 수 있어야 하고, 
   Prometheus나 InfluxDB, ELK 스택 같은 다양한 도구와 잘 맞물려 돌아가야 해요.
* 실시간 데이터 처리
  * 모아진 데이터는 바로바로 처리되어야 하고, 이를 통해 문제를 즉시 알아차리고 대응할 수 있어야 해요.
* 알림 설정 유연성
  * 문제의 심각도나 어디서 생겼는지, 누가 담당하는지에 따라 알림 우선순위나 받는 사람을 다르게 설정할 수 있어야 해요.

### 📢 알림 방식은 어떻게 되나요? 
> 모니터링 시스템은 여러 방식으로 개발자에게 알림을 줘요:

* 이메일과 SMS: 가장 기본적인 방법으로, 문제가 생기면 바로 이메일이나 SMS를 보내요.
* 모바일 앱 푸시 알림: 특정 모니터링 앱을 통해 실시간으로 푸시 알림을 받을 수 있어요.
* 채팅 툴 연동: Slack이나 Microsoft Teams 같은 채팅 툴과 연동해서, 문제가 생기면 바로 채팅방에 알림을 보내요.
* 자동화된 전화 호출: 문제가 크면 Opsgenie 같은 서비스를 통해 담당자에게 자동으로 전화를 걸어서 알려주기도 해요.

> 이렇게 알림 시스템을 잘 갖춰놓으면, 개발자가 문제를 바로 알아차리고 필요한 조치를 취할 수 있게 돼요. 게다가, 장애 대응 프로세스를 더 빠르고 효율적으로 만들 수 있죠 🏃‍♂️💨.
